# 商信通道报备方案

## 一、需求背景

商信的通道部署在我司平台，由商信与我司共同使用，但**子端口的管理由商信负责**。  
当前整体操作流程如下：

1. 商信到运营商侧报备签名信息  
2. 商信报备完成后，通过测试脚本进行批量测试  
   - 工具：54. 子端口报备测试工具  
3. 我司从商信测试成功的数据中  
   - 每个签名筛选一个子端口  
   - 导入平台  
   - 再通过批量测试功能进行二次测试  
4. 测试结果处理  
   - **测试成功**  
     - 接入号编码签名报备自动启用  
     - 运营同学将签名配置到关联账号  
   - **测试失败**  
     - 联系商信  
     - 更换其他端口  

当出现以下情况时，需要重新走完整流程（**高频且易出错**）：

- 签名整改  
- 子端口拉黑  
- 子端口更换 / 下线  

---

## 二、痛点分析

- 各流程环节**都有明确评估标准**
- 但目前**未实现自动化**
- 严重依赖我司运营人员人工操作
- 存在问题：
  - 人力成本高  
  - 流程耗时  
  - 容易遗漏  
  - 容易出错  

---

## 三、方案说明

### 1. 需求详情

在**报备系统**中，为商信开发一个独立页面，实现：

- 商信可**自主管理**
  - 通道
  - 账号签名
  - 子端口信息
- 将签名子端口数据**直接导入我司平台**
- 自主完成：
  - 测试
  - 启用 / 禁用子端口  

---

### 2. 操作流程

#### 2.1 子端口数据导入

- 商信在新页面导入签名子端口数据  
- 导入字段详见表格  
- 示例文件：  
  - `接入号编码报备范例.xlsx`

导入时需选择：

- **通道编码**
  - 仅展示固定范围的值  
  - 建议配置化，支持运营自主维护  
- **账号**
  - 仅展示固定范围的值  
  - 建议配置化，支持运营自主维护  

**异常处理：**

- 导入失败时，可下载错误文件

---

#### 2.2 测试能力

- 支持商信**一键测试**导入的签名 / 子端口数据
- 测试方式：
  - 按导入的 **任务 ID** 批量测试
  - 按筛选条件批量测试
- 测试结果处理：
  - **测试成功** → 子端口自动启用（沿用历史测试逻辑）

---

#### 2.3 引流信息导入

- 商信导入 **子端口引流信息**
- 导入字段见表格  
- 示例文件：
  - `接入号编码报备范例.xlsx`
- 引流信息导入后：
  - **默认启用**

---

#### 2.4 子端口维护能力

支持在页面中按条件筛选后，对单个或多个子端口进行：

- 启用
- 禁用
- 删除

---

## 四、导入字段说明

> ⚠️ 部分字段**不对外暴露**，需遵循规则说明

| 字段名称（生产平台） | 字段说明（报备平台） | 规则说明 |
|------------------|------------------|------|
| *通道编码 | 删除 | 导入表格中不需要，导入时在页面选择 |
| *签名 | 一致 |  |
| 扩展码 | 一致 |  |
| 是否加白(0否1是) | 删除 | 默认否 |
| 发送类型(0行销1行业2营销) | 一致 |  |
| 备注 | 一致 |  |
| 报备状态 | 删除 | 默认已完成 |
| 模版内容 | 删除 | 根据手机号 / 链接规则自动生成 |
| 联系方式 | 拆分字段 | 用 `;` 不方便操作 |
| 链接 | 限制 | 只能添加一个链接 |
| 模版是否启用 | 删除 | 默认启用 |

---

### 模版内容生成规则

根据导入数据自动生成，共 4 种情况：

1. **无手机号、无链接**  
   - 空  
2. **仅手机号**  
